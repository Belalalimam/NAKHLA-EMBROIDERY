@{
    ViewBag.Title = "Product Management";
    ViewBag.PageTitle = "Products";
    ViewBag.Subtitle = "Manage your products";
}

<!-- Mobile Table Hint -->
<div class="mobile-scroll-hint" style="display: none; background: #f1f5f9; padding: 8px; text-align: center; color: #64748b; font-size: 12px; border-radius: 6px; margin-bottom: 15px;">
    <i class="fas fa-arrows-left-right"></i> Swipe horizontally to view all columns
</div>

<!-- Page Header -->
<div class="page-header">
    <div>
        <h2>Products</h2>
        <p class="page-subtitle">Manage your product catalog</p>
    </div>
    <div class="header-actions">
        <button class="btn btn-secondary">
            <i class="fas fa-filter"></i>
            <span class="desktop-text">Filter</span>
        </button>
        <button class="btn btn-primary" onclick="openProductModal('add', null)">
            <i class="fas fa-plus"></i>
            <span class="desktop-text">Add Product</span>
        </button>
    </div>
</div>

<!-- Products Statistics -->
<div class="orders-stats-container">
    <div class="orders-stat-card">
        <div class="orders-stat-title">Total Products</div>
        <div class="orders-stat-value">1,234</div>
        <div class="orders-stat-desc">+8% from last month</div>
    </div>
    <div class="orders-stat-card">
        <div class="orders-stat-title">In Stock</div>
        <div class="orders-stat-value">856</div>
        <div class="orders-stat-desc">Ready to ship</div>
    </div>
    <div class="orders-stat-card">
        <div class="orders-stat-title">Out of Stock</div>
        <div class="orders-stat-value">24</div>
        <div class="orders-stat-desc">Needs restocking</div>
    </div>
    <div class="orders-stat-card">
        <div class="orders-stat-title">Low Stock</div>
        <div class="orders-stat-value">12</div>
        <div class="orders-stat-desc">Below threshold</div>
    </div>
</div>

<!-- Quick Stats Cards -->
<div class="cards-grid">
    <div class="card">
        <div class="card-header">
            <h3>Top Selling Category</h3>
            <span class="card-badge">Tools & Hardware</span>
        </div>
        <div class="card-body">
            <p>345 units sold this month</p>
            <button class="btn btn-sm btn-primary" onclick="viewCategory('tools')">
                <i class="fas fa-chart-line"></i>
                <span class="desktop-text">View Details</span>
            </button>
        </div>
    </div>

    <div class="card">
        <div class="card-header">
            <h3>Low Stock Alert</h3>
            <span class="card-badge">12 items</span>
        </div>
        <div class="card-body">
            <p>Products with stock below minimum threshold</p>
            <button class="btn btn-sm btn-warning" onclick="viewLowStock()">
                <i class="fas fa-exclamation-triangle"></i>
                <span class="desktop-text">View Details</span>
            </button>
        </div>
    </div>

    <div class="card">
        <div class="card-header">
            <h3>Inventory Value</h3>
            <span class="card-badge">$256,890</span>
        </div>
        <div class="card-body">
            <p>Total value of all inventory</p>
            <button class="btn btn-sm btn-success" onclick="viewInventoryValue()">
                <i class="fas fa-chart-pie"></i>
                <span class="desktop-text">View Report</span>
            </button>
        </div>
    </div>
</div>

<!-- Filters -->
<div class="filters">
    <div class="filter-group">
        <button class="filter-btn active" onclick="filterProducts('all')">
            <span>All Products</span>
            <span class="badge badge-primary">1,234</span>
        </button>
        <button class="filter-btn" onclick="filterProducts('active')">
            <span>Active</span>
            <span class="badge badge-success">1,120</span>
        </button>
        <button class="filter-btn" onclick="filterProducts('inactive')">
            <span>Inactive</span>
            <span class="badge badge-warning">114</span>
        </button>
        <button class="filter-btn" onclick="filterProducts('lowstock')">
            <span>Low Stock</span>
            <span class="badge badge-danger">12</span>
        </button>
        <button class="filter-btn" onclick="filterProducts('outofstock')">
            <span>Out of Stock</span>
            <span class="badge badge-danger">24</span>
        </button>
    </div>
    <div class="action-buttons">
        <button class="btn btn-secondary" onclick="exportProducts()">
            <i class="fas fa-file-export"></i>
            <span class="desktop-text">Export</span>
        </button>
        <button class="btn btn-secondary" onclick="printProducts()">
            <i class="fas fa-print"></i>
            <span class="desktop-text">Print</span>
        </button>
    </div>
</div>

<!-- Products Table -->
<div class="data-table-container">
    <div class="table-header">
        <h2>All Products</h2>
        <div class="table-actions">
            <div class="search-container">
                <input type="text" placeholder="Search products..." class="table-search" id="productSearch" onkeyup="searchProducts()">
                <i class="fas fa-search"></i>
            </div>
            <div>
                <button class="table-action" onclick="refreshProducts()">
                    <i class="fas fa-sync-alt"></i>
                    <span class="desktop-text">Refresh</span>
                </button>
                <button class="table-action" onclick="showColumnSettings()">
                    <i class="fas fa-columns"></i>
                    <span class="desktop-text">Columns</span>
                </button>
            </div>
        </div>
    </div>

    <table class="data-table" id="productsTable">
        <thead>
            <tr>
                <th style="width: 50px;">
                    <input type="checkbox" id="selectAllProducts" onchange="toggleSelectAllProducts(this)">
                </th>
                <th data-sortable="true" onclick="sortTable(1)">
                    Product <i class="fas fa-sort"></i>
                </th>
                <th data-sortable="true" onclick="sortTable(2)">
                    SKU <i class="fas fa-sort"></i>
                </th>
                <th data-sortable="true" onclick="sortTable(3)">
                    Category <i class="fas fa-sort"></i>
                </th>
                <th data-sortable="true" onclick="sortTable(4)">
                    Brand <i class="fas fa-sort"></i>
                </th>
                <th data-sortable="true" onclick="sortTable(5)">
                    Price <i class="fas fa-sort"></i>
                </th>
                <th data-sortable="true" onclick="sortTable(6)">
                    Stock <i class="fas fa-sort"></i>
                </th>
                <th data-sortable="true" onclick="sortTable(7)">
                    Status <i class="fas fa-sort"></i>
                </th>
                <th style="width: 150px;">Actions</th>
            </tr>
        </thead>
        <tbody>
            <!-- Product 1 -->
            <tr data-product-id="1" onclick="selectProductRow(event, this)">
                <td onclick="event.stopPropagation()">
                    <input type="checkbox" class="product-select" value="1" onchange="updateProductSelection(this)">
                </td>
                <td>
                    <div class="product-info">
                        <div class="product-name">Gasoline generator EYG 7500L</div>
                        <div class="product-description">With inverter technology, 7500W power output</div>
                    </div>
                </td>
                <td>
                    <div class="sku">PROD-001</div>
                </td>
                <td>
                    <span class="category-badge">Tools & Hardware</span>
                </td>
                <td>
                    <span class="brand-badge">Stihl</span>
                </td>
                <td>
                    <div class="price-info">
                        <div class="current-price">$1,590.00</div>
                        <div class="compare-price">$1,790.00</div>
                    </div>
                </td>
                <td>
                    <div class="stock-info">
                        <span class="stock-badge stock-available">42 in stock</span>
                        <div class="stock-progress">
                            <div class="progress-bar" style="width: 84%"></div>
                        </div>
                    </div>
                </td>
                <td>
                    <div class="status-indicator">
                        <span class="status-dot dot-active"></span>
                        <span class="status-text">Active</span>
                    </div>
                </td>
                <td onclick="event.stopPropagation()">
                    <div class="row-actions">
                        <button class="row-action view" onclick="viewProduct(1, event)">
                            <i class="fas fa-eye"></i>
                            <span class="desktop-text">View</span>
                        </button>
                        <button class="row-action edit" onclick="editProduct(1, event)">
                            <i class="fas fa-edit"></i>
                            <span class="desktop-text">Edit</span>
                        </button>
                        <button class="row-action delete" onclick="deleteProduct(1, event)">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                </td>
            </tr>

            <!-- Product 2 -->
            <tr data-product-id="2" onclick="selectProductRow(event, this)">
                <td onclick="event.stopPropagation()">
                    <input type="checkbox" class="product-select" value="2" onchange="updateProductSelection(this)">
                </td>
                <td>
                    <div class="product-info">
                        <div class="product-name">Stihl TS 800 cut-off machine</div>
                        <div class="product-description">Includes 5x diamond cutting discs, professional grade</div>
                    </div>
                </td>
                <td>
                    <div class="sku">PROD-002</div>
                </td>
                <td>
                    <span class="category-badge">Tools & Hardware</span>
                </td>
                <td>
                    <span class="brand-badge">Stihl</span>
                </td>
                <td>
                    <div class="price-info">
                        <div class="current-price">$1,327.89</div>
                        <div class="compare-price">$1,590.00</div>
                    </div>
                </td>
                <td>
                    <div class="stock-info">
                        <span class="stock-badge stock-low">3 in stock</span>
                        <div class="stock-progress">
                            <div class="progress-bar" style="width: 15%"></div>
                        </div>
                    </div>
                </td>
                <td>
                    <div class="status-indicator">
                        <span class="status-dot dot-active"></span>
                        <span class="status-text">Active</span>
                    </div>
                </td>
                <td onclick="event.stopPropagation()">
                    <div class="row-actions">
                        <button class="row-action view" onclick="viewProduct(2, event)">
                            <i class="fas fa-eye"></i>
                            <span class="desktop-text">View</span>
                        </button>
                        <button class="row-action edit" onclick="editProduct(2, event)">
                            <i class="fas fa-edit"></i>
                            <span class="desktop-text">Edit</span>
                        </button>
                        <button class="row-action delete" onclick="deleteProduct(2, event)">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                </td>
            </tr>

            <!-- Product 3 -->
            <tr data-product-id="3" onclick="selectProductRow(event, this)">
                <td onclick="event.stopPropagation()">
                    <input type="checkbox" class="product-select" value="3" onchange="updateProductSelection(this)">
                </td>
                <td>
                    <div class="product-info">
                        <div class="product-name">Professional Drill Set</div>
                        <div class="product-description">32-piece cordless drill set with carrying case</div>
                    </div>
                </td>
                <td>
                    <div class="sku">PROD-003</div>
                </td>
                <td>
                    <span class="category-badge">Tools & Hardware</span>
                </td>
                <td>
                    <span class="brand-badge">Premium</span>
                </td>
                <td>
                    <div class="price-info">
                        <div class="current-price">$289.99</div>
                    </div>
                </td>
                <td>
                    <div class="stock-info">
                        <span class="stock-badge stock-out">Out of stock</span>
                        <div class="stock-progress">
                            <div class="progress-bar" style="width: 0%"></div>
                        </div>
                    </div>
                </td>
                <td>
                    <div class="status-indicator">
                        <span class="status-dot dot-inactive"></span>
                        <span class="status-text">Inactive</span>
                    </div>
                </td>
                <td onclick="event.stopPropagation()">
                    <div class="row-actions">
                        <button class="row-action view" onclick="viewProduct(3, event)">
                            <i class="fas fa-eye"></i>
                            <span class="desktop-text">View</span>
                        </button>
                        <button class="row-action edit" onclick="editProduct(3, event)">
                            <i class="fas fa-edit"></i>
                            <span class="desktop-text">Edit</span>
                        </button>
                        <button class="row-action delete" onclick="deleteProduct(3, event)">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>

    <!-- Pagination -->
@*     <div class="pagination">
        <a href="#" class="page-item disabled">
            <i class="fas fa-chevron-left"></i>
        </a>
        <a href="#" class="page-item active">1</a>
        <a href="#" class="page-item">2</a>
        <a href="#" class="page-item">3</a>
        <a href="#" class="page-item">4</a>
        <a href="#" class="page-item">5</a>
        <span class="page-item">...</span>
        <a href="#" class="page-item">10</a>
        <a href="#" class="page-item">
            <i class="fas fa-chevron-right"></i>
        </a>
    </div>
</div> *@

<!-- Selection Actions Bar -->
<div class="selection-actions" id="selectionActions">
    <div class="selected-count">
        <span id="selectedCount">0</span> products selected
    </div>
    <div class="selection-buttons">
        <button class="btn btn-secondary" onclick="exportSelectedProducts()">
            <i class="fas fa-file-export"></i>
            <span class="desktop-text">Export</span>
        </button>
        <button class="btn btn-danger" onclick="deleteSelectedProducts()">
            <i class="fas fa-trash"></i>
            <span class="desktop-text">Delete</span>
        </button>
        <button class="btn btn-secondary" onclick="clearProductSelection()">
            <i class="fas fa-times"></i>
            <span class="desktop-text">Clear</span>
        </button>
    </div>
</div>


@section Scripts {
    <script>
        // Product Management JavaScript
        let selectedProducts = new Set();
        let currentSortColumn = null;
        let sortDirection = 'asc';

        document.addEventListener('DOMContentLoaded', function () {
            console.log('Products page initialized');
            initProductPage();
        });

        function initProductPage() {
            // Initialize mobile hint
            const mobileHint = document.querySelector('.mobile-scroll-hint');
            if (window.innerWidth <= 768) {
                mobileHint.style.display = 'block';
            }

            // Update on resize
            window.addEventListener('resize', function() {
                mobileHint.style.display = window.innerWidth <= 768 ? 'block' : 'none';
            });

            // Initialize selection actions
            updateSelectionUI();
        }

        // Row Selection
        function selectProductRow(event, row) {
            if (event.target.type === 'checkbox' ||
                event.target.closest('.row-actions') ||
                event.target.closest('.product-info')) {
                return;
            }

            const checkbox = row.querySelector('.product-select');
            if (checkbox) {
                checkbox.checked = !checkbox.checked;
                updateProductSelection(checkbox);
            }
        }

        function updateProductSelection(checkbox) {
            const productId = checkbox.value;

            if (checkbox.checked) {
                selectedProducts.add(productId);
                checkbox.closest('tr').classList.add('selected');
            } else {
                selectedProducts.delete(productId);
                checkbox.closest('tr').classList.remove('selected');
                document.getElementById('selectAllProducts').checked = false;
            }

            updateSelectionUI();
        }

        function toggleSelectAllProducts(selectAllCheckbox) {
            const checkboxes = document.querySelectorAll('.product-select');
            checkboxes.forEach(checkbox => {
                checkbox.checked = selectAllCheckbox.checked;
                updateProductSelection(checkbox);
            });
        }

        function clearProductSelection() {
            selectedProducts.clear();
            document.querySelectorAll('.product-select').forEach(cb => {
                cb.checked = false;
                cb.closest('tr').classList.remove('selected');
            });
            document.getElementById('selectAllProducts').checked = false;
            updateSelectionUI();
        }

        function updateSelectionUI() {
            const count = selectedProducts.size;
            const selectedCountEl = document.getElementById('selectedCount');
            const actionsBar = document.getElementById('selectionActions');

            if (selectedCountEl) {
                selectedCountEl.textContent = count;
            }

            if (actionsBar) {
                if (count > 0) {
                    actionsBar.classList.add('active');
                } else {
                    actionsBar.classList.remove('active');
                }
            }
        }

        // Product Actions
        function viewProduct(productId, event) {
            if (event) event.stopPropagation();

            const productData = getProductData(productId);
            openProductModal('view', productData);
        }

        function editProduct(productId, event) {
            if (event) event.stopPropagation();

            const productData = getProductData(productId);
            openProductModal('edit', productData);
        }

        function deleteProduct(productId, event) {
            if (event) event.stopPropagation();

            const productName = getProductName(productId);
            if (confirm(`Are you sure you want to delete "${productName}"?`)) {
                console.log('Deleting product:', productId);
                const row = document.querySelector(`tr[data-product-id="${productId}"]`);
                if (row) {
                    row.remove();
                    selectedProducts.delete(productId.toString());
                    updateSelectionUI();
                }
            }
        }

        // Bulk Actions
        function exportSelectedProducts() {
            if (selectedProducts.size === 0) {
                alert('Please select at least one product');
                return;
            }
            alert(`Exporting ${selectedProducts.size} selected products...`);
        }

        function deleteSelectedProducts() {
            if (selectedProducts.size === 0) {
                alert('Please select at least one product');
                return;
            }

            if (confirm(`Delete ${selectedProducts.size} selected products?`)) {
                selectedProducts.forEach(id => {
                    const row = document.querySelector(`tr[data-product-id="${id}"]`);
                    if (row) row.remove();
                });
                clearProductSelection();
            }
        }

        // Filter Functions
        function filterProducts(filter) {
            const filterBtns = document.querySelectorAll('.filter-group .filter-btn');
            filterBtns.forEach(btn => btn.classList.remove('active'));

            const activeBtn = document.querySelector(`.filter-btn[onclick*="${filter}"]`);
            if (activeBtn) {
                activeBtn.classList.add('active');
            }

            console.log('Filtering by:', filter);
            // Add your filter logic here
        }

        function searchProducts() {
            const searchTerm = document.getElementById('productSearch').value.toLowerCase();
            const rows = document.querySelectorAll('#productsTable tbody tr');

            rows.forEach(row => {
                const text = row.textContent.toLowerCase();
                if (text.includes(searchTerm)) {
                    row.style.display = '';
                } else {
                    row.style.display = 'none';
                }
            });
        }

        // Sort Function
        function sortTable(columnIndex) {
            const table = document.getElementById('productsTable');
            const tbody = table.querySelector('tbody');
            const rows = Array.from(tbody.querySelectorAll('tr'));

            // Update sort direction
            if (currentSortColumn === columnIndex) {
                sortDirection = sortDirection === 'asc' ? 'desc' : 'asc';
            } else {
                currentSortColumn = columnIndex;
                sortDirection = 'asc';
            }

            // Sort rows
            rows.sort((a, b) => {
                const aValue = a.cells[columnIndex].textContent.trim().toLowerCase();
                const bValue = b.cells[columnIndex].textContent.trim().toLowerCase();

                if (sortDirection === 'asc') {
                    return aValue.localeCompare(bValue);
                } else {
                    return bValue.localeCompare(aValue);
                }
            });

            // Reorder rows in table
            rows.forEach(row => tbody.appendChild(row));

            // Update sort icons
            updateSortIcons(columnIndex);
        }

        function updateSortIcons(columnIndex) {
            const headers = document.querySelectorAll('#productsTable th[data-sortable] i');
            headers.forEach((icon, index) => {
                if (index === columnIndex) {
                    icon.className = sortDirection === 'asc' ? 'fas fa-sort-up' : 'fas fa-sort-down';
                } else {
                    icon.className = 'fas fa-sort';
                }
            });
        }

        // Helper functions
        function getProductData(productId) {
            const products = {
                1: {
                    id: 1,
                    name: 'Gasoline generator EYG 7500L',
                    sku: 'PROD-001',
                    category: 'Tools & Hardware',
                    brand: 'Stihl',
                    price: '1590.00',
                    comparePrice: '1790.00',
                    stock: '42',
                    status: 'active',
                    description: 'With inverter technology, 7500W power output'
                },
                2: {
                    id: 2,
                    name: 'Stihl TS 800 cut-off machine',
                    sku: 'PROD-002',
                    category: 'Tools & Hardware',
                    brand: 'Stihl',
                    price: '1327.89',
                    comparePrice: '1590.00',
                    stock: '3',
                    status: 'active',
                    description: 'Includes 5x diamond cutting discs, professional grade'
                },
                3: {
                    id: 3,
                    name: 'Professional Drill Set',
                    sku: 'PROD-003',
                    category: 'Tools & Hardware',
                    brand: 'Premium',
                    price: '289.99',
                    comparePrice: '',
                    stock: '0',
                    status: 'inactive',
                    description: '32-piece cordless drill set with carrying case'
                }
            };

            return products[productId] || {
                id: productId,
                name: 'Product Name',
                sku: 'PROD-000',
                category: 'Category',
                brand: 'Brand',
                price: '0.00',
                comparePrice: '',
                stock: '0',
                status: 'inactive',
                description: 'Product description'
            };
        }

        function getProductName(productId) {
            const product = getProductData(productId);
            return product.name;
        }

        // Modal Functions
        function openProductModal(action, productData) {
            const modal = document.getElementById('universalModal');
            const modalContent = document.getElementById('modalContent');

            if (!modal || !modalContent) return;

            let title = '';
            let content = '';

            switch (action) {
                case 'add':
                    title = 'Add New Product';
                    content = getProductFormHTML(null);
                    break;
                case 'edit':
                    title = 'Edit Product';
                    content = getProductFormHTML(productData);
                    break;
                case 'view':
                    title = 'View Product';
                    content = getProductViewHTML(productData);
                    break;
            }

            modalContent.innerHTML = `
                <div class="modal-header">
                    <h3>${title}</h3>
                    <button class="modal-close" onclick="closeModal()">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="modal-body">
                    ${content}
                </div>
                <div class="modal-footer">
                    ${action === 'view' ? `
                        <button class="btn btn-secondary" onclick="closeModal()">Close</button>
                        <button class="btn btn-primary" onclick="editProduct(${productData.id})">Edit</button>
                    ` : `
                        <button class="btn btn-secondary" onclick="closeModal()">Cancel</button>
                        <button class="btn btn-primary" onclick="saveProduct(${action === 'edit' ? productData.id : 'null'})">Save Product</button>
                    `}
                </div>
            `;

            modal.style.display = 'flex';
            document.body.style.overflow = 'hidden';
        }

        function getProductFormHTML(productData) {
            const isEdit = productData !== null;

            return `
                <div class="product-form">
                    <div class="form-group">
                        <label class="form-label">Product Name *</label>
                        <input type="text" class="form-control" id="productName"
                               value="${isEdit ? productData.name : ''}"
                               placeholder="Enter product name" required>
                    </div>

                    <div class="form-row">
                        <div class="form-col">
                            <label class="form-label">SKU *</label>
                            <input type="text" class="form-control" id="productSKU"
                                   value="${isEdit ? productData.sku : ''}"
                                   placeholder="e.g., PROD-001" required>
                        </div>
                        <div class="form-col">
                            <label class="form-label">Barcode</label>
                            <input type="text" class="form-control" id="productBarcode"
                                   placeholder="Optional barcode">
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-col">
                            <label class="form-label">Category *</label>
                            <select class="form-control" id="productCategory" required>
                                <option value="">Select category</option>
                                <option value="tools" ${isEdit && productData.category === 'Tools & Hardware' ? 'selected' : ''}>Tools & Hardware</option>
                                <option value="safety" ${isEdit && productData.category === 'Safety Equipment' ? 'selected' : ''}>Safety Equipment</option>
                                <option value="electrical">Electrical</option>
                                <option value="plumbing">Plumbing</option>
                            </select>
                        </div>
                        <div class="form-col">
                            <label class="form-label">Brand</label>
                            <input type="text" class="form-control" id="productBrand"
                                   value="${isEdit ? productData.brand : ''}"
                                   placeholder="Enter brand name">
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-col">
                            <label class="form-label">Price ($) *</label>
                            <input type="number" class="form-control" id="productPrice"
                                   value="${isEdit ? productData.price : ''}"
                                   placeholder="0.00" step="0.01" min="0" required>
                        </div>
                        <div class="form-col">
                            <label class="form-label">Compare Price ($)</label>
                            <input type="number" class="form-control" id="productComparePrice"
                                   value="${isEdit ? productData.comparePrice || '' : ''}"
                                   placeholder="Optional" step="0.01" min="0">
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-col">
                            <label class="form-label">Stock Quantity *</label>
                            <input type="number" class="form-control" id="productStock"
                                   value="${isEdit ? productData.stock : ''}"
                                   placeholder="0" min="0" required>
                        </div>
                        <div class="form-col">
                            <label class="form-label">Reorder Level</label>
                            <input type="number" class="form-control" id="productReorderLevel"
                                   value="10" placeholder="10" min="0">
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Description</label>
                        <textarea class="form-control" id="productDescription" rows="3"
                                  placeholder="Enter product description">${isEdit ? productData.description : ''}</textarea>
                    </div>

                    <div class="form-group">
                        <div class="form-check">
                            <input type="checkbox" class="form-check-input" id="productActive"
                                   ${isEdit && productData.status === 'active' ? 'checked' : 'checked'}>
                            <label class="form-check-label" for="productActive">Active (visible to customers)</label>
                        </div>
                    </div>
                </div>
            `;
        }

        function getProductViewHTML(productData) {
            return `
                <div class="product-view">
                    <div class="product-header mb-3">
                        <h4>${productData.name}</h4>
                        <div class="text-muted">${productData.sku}</div>
                    </div>

                    <div class="product-details">
                        <div class="detail-row mb-2">
                            <strong>Category:</strong> ${productData.category}
                        </div>
                        <div class="detail-row mb-2">
                            <strong>Brand:</strong> ${productData.brand}
                        </div>
                        <div class="detail-row mb-2">
                            <strong>Price:</strong> $${parseFloat(productData.price).toFixed(2)}
                        </div>
                        <div class="detail-row mb-2">
                            <strong>Stock:</strong> ${productData.stock} units
                        </div>
                        <div class="detail-row mb-3">
                            <strong>Status:</strong>
                            <span class="badge ${productData.status === 'active' ? 'badge-success' : 'badge-warning'}">
                                ${productData.status === 'active' ? 'Active' : 'Inactive'}
                            </span>
                        </div>

                        <div class="product-description mt-3">
                            <h5>Description</h5>
                            <p>${productData.description}</p>
                        </div>
                    </div>
                </div>
            `;
        }

        function saveProduct(productId) {
            const name = document.getElementById('productName').value;
            const sku = document.getElementById('productSKU').value;
            const price = document.getElementById('productPrice').value;
            const stock = document.getElementById('productStock').value;

            if (!name || !sku || !price || !stock) {
                alert('Please fill in all required fields');
                return;
            }

            console.log('Saving product:', { productId, name, sku, price, stock });
            alert(productId ? 'Product updated successfully!' : 'Product added successfully!');
            closeModal();
        }

        // Utility Functions
        function exportProducts() {
            alert('Exporting all products...');
        }

        function printProducts() {
            window.print();
        }

        function refreshProducts() {
            console.log('Refreshing products...');
            // Add refresh logic here
        }

        function showColumnSettings() {
            alert('Column settings modal would open here');
        }

        function viewCategory(category) {
            alert(`Viewing ${category} category...`);
        }

        function viewLowStock() {
            alert('Showing low stock products...');
        }

        function viewInventoryValue() {
            alert('Showing inventory value report...');
        }

        function exportSelected() {
            exportSelectedProducts();
        }

        function deleteSelected() {
            deleteSelectedProducts();
        }

        function clearSelection() {
            clearProductSelection();
        }

        // Make functions global
        window.selectProductRow = selectProductRow;
        window.updateProductSelection = updateProductSelection;
        window.toggleSelectAllProducts = toggleSelectAllProducts;
        window.clearProductSelection = clearProductSelection;
        window.viewProduct = viewProduct;
        window.editProduct = editProduct;
        window.deleteProduct = deleteProduct;
        window.exportSelectedProducts = exportSelectedProducts;
        window.deleteSelectedProducts = deleteSelectedProducts;
        window.filterProducts = filterProducts;
        window.searchProducts = searchProducts;
        window.sortTable = sortTable;
        window.openProductModal = openProductModal;
        window.saveProduct = saveProduct;
        window.exportSelected = exportSelected;
        window.deleteSelected = deleteSelected;
        window.clearSelection = clearSelection;
    </script>
}