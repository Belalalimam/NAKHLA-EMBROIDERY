@model NAKHLA.Models.Brand

<div class="modal-header">
    <h3>Add New Brand</h3>
    <button type="button" class="modal-close" onclick="closeModal()">
        <i class="fas fa-times"></i>
    </button>
</div>

@using (Html.BeginForm("Create", "Brands", FormMethod.Post, new { id = "createBrandForm" }))
{
    @Html.AntiForgeryToken()

    <div class="modal-body">
        <div class="form-group">
            @Html.LabelFor(model => model.Name, new { @class = "form-label" })
            @Html.TextBoxFor(model => model.Name, new { @class = "form-control", required = "required" })
            @Html.ValidationMessageFor(model => model.Name)
        </div>

        <div class="form-group">
            @Html.LabelFor(model => model.Description, new { @class = "form-label" })
            @Html.TextAreaFor(model => model.Description, new { @class = "form-control", rows = "3" })
            @Html.ValidationMessageFor(model => model.Description)
        </div>

        <div class="form-group">
            @Html.LabelFor(model => model.Website, new { @class = "form-label" })
            @Html.TextBoxFor(model => model.Website, new { @class = "form-control", type = "url", placeholder = "https://" })
            @Html.ValidationMessageFor(model => model.Website)
        </div>

        <div class="row">
            <div class="col-6">
                <div class="form-group">
                    @Html.LabelFor(model => model.Status, new { @class = "form-label" })
                    @Html.DropDownListFor(model => model.Status,
                    new SelectList(new[] { "Active", "Inactive", "Pending" }),
                                new { @class = "form-control" })
            </div>
        </div>
        <div class="col-6">
            <div class="form-group">
                <label class="form-label">Initial Products</label>
                <input type="number" class="form-control" name="InitialProducts" value="0" min="0" />
            </div>
        </div>
    </div>

    <div class="form-check mb-3">
        @Html.CheckBoxFor(model => model.IsFeatured, new { @class = "form-check-input" })
        @Html.LabelFor(model => model.IsFeatured, "Featured Brand", new { @class = "form-check-label" })
    </div>
</div>

<div class="modal-footer">
    <button type="button" class="btn btn-secondary" onclick="closeModal()">Cancel</button>
    <button type="submit" class="btn btn-primary">
        <i class="fas fa-save"></i> Save Brand
    </button>
</div>
}
 <!-- THIS CLOSING BRACE WAS MISSING! -->

<script>
    // Handle form submission via AJAX
    $(document).ready(function() {
        $('#createBrandForm').on('submit', function(e) {
            e.preventDefault();

            $.ajax({
                url: $(this).attr('action'),
                type: 'POST',
                data: $(this).serialize(),
                success: function(response) {
                    if (response.success) {
                        // Close modal and refresh table
                        closeModal();
                        window.location.reload();
                    } else {
                        // Show validation errors
                        $('#createBrandForm').html(response);
                    }
                },
                error: function() {
                    alert('Error saving brand');
                }
            });
        });
    });
</script>